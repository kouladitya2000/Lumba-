if (-not $finalResults -or $finalResults.Count -eq 0) {
    Write-Output "No compliant/non-compliant records to insert. Exiting..."
    return
}

Write-Output "Pushing $($finalResults.Count) records to SQL database..."

Add-ArrayToDbTblCompliance `
    -DbServerName "<your-sql-server-name>" `
    -DbName "<your-database-name>" `
    -TableName "<your-table-name>" `
    -DataArray $finalResults `
    -DataCollectionTime $collectionTime `
    -ScriptAssignmentName "audit_guardium_agent" `
    -ScriptAssignmentId "audit_guardium_agent" `
    -ScriptDefinitionName "audit_guardium_agent" `
    -ScriptDefinitionId "audit_guardium_agent" `
    -ScriptSetDefinitionName "audit_guardium_agent" `
    -ScriptSetDefinitionId "audit_guardium_agent" `
    -VersionInfo "1.0"

Write-Output "Data successfully pushed to SQL."
